Version 4
SHEET 1 1240 680
WIRE -672 -272 -672 -320
WIRE -672 -160 -672 -192
WIRE -576 -48 -944 -48
WIRE -48 -48 -48 -96
WIRE -944 -32 -944 -48
WIRE -576 80 -576 -48
WIRE -528 80 -576 80
WIRE -304 80 -528 80
WIRE -48 80 -48 32
WIRE -48 80 -224 80
WIRE 128 80 -48 80
WIRE -48 112 -48 80
WIRE 208 112 208 64
WIRE 176 128 96 128
WIRE -576 144 -576 80
WIRE 320 144 240 144
WIRE 448 144 400 144
WIRE 560 144 448 144
WIRE 624 144 560 144
WIRE 128 160 128 80
WIRE 176 160 128 160
WIRE 560 176 560 144
WIRE -1344 192 -1344 112
WIRE -944 208 -944 48
WIRE -48 224 -48 192
WIRE 208 224 208 176
WIRE 560 272 560 240
WIRE -1344 320 -1344 272
WIRE -944 320 -944 288
WIRE -576 320 -576 224
WIRE -576 320 -944 320
WIRE -320 320 -576 320
WIRE 96 320 96 128
WIRE 96 320 -240 320
WIRE 144 320 96 320
WIRE 288 320 224 320
WIRE 448 320 448 144
WIRE 448 320 288 320
WIRE -576 384 -576 320
WIRE 96 432 96 320
WIRE 160 432 96 432
WIRE 288 432 288 320
WIRE 288 432 224 432
WIRE -1344 448 -1344 400
FLAG -672 -160 0
FLAG -672 -320 3V3
IOPIN -672 -320 Out
FLAG -48 -96 3V3
IOPIN -48 -96 In
FLAG 208 64 3V3
IOPIN 208 64 In
FLAG 208 224 0
FLAG 624 144 Vo
IOPIN 624 144 Out
FLAG 560 272 0
FLAG -576 384 0
FLAG -528 80 Vsns
IOPIN -528 80 Out
FLAG -48 224 0
FLAG -1344 448 0
SYMBOL res -592 128 R0
SYMATTR InstName R1
SYMATTR Value {Rs}
SYMBOL res -208 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R1}
SYMBOL res -224 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R1}
SYMBOL res -64 -64 R0
SYMATTR InstName R4
SYMATTR Value {2*R2}
SYMBOL voltage -672 -288 R0
SYMATTR InstName V1
SYMATTR Value 3.3
SYMBOL res 416 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {Rlp}
SYMBOL cap 544 176 R0
SYMATTR InstName C1
SYMATTR Value {Clp}
SYMBOL res 240 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {R2}
SYMBOL voltage -944 -48 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V3
SYMATTR Value ""
SYMBOL res -64 96 R0
SYMATTR InstName R7
SYMATTR Value {2*R2}
SYMBOL cap 224 416 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value {C}
SYMBOL voltage -1344 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(0 0.1 0 10n 10n 6u 10u)
SYMBOL voltage -1344 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value PULSE(0 0.1 0 6u 10n 0 10u)
SYMBOL voltage -944 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(0 200m 200k)
SYMBOL Opamps\\AD823 208 80 R0
SYMATTR InstName U1
TEXT 368 -216 Left 2 !.param Rs = 100m\n.param R1 = 2k\n.param R2 = 15k\n.param Rlp = 100\n.param Clp = 100p\n.param C=5.1p
TEXT 376 384 Left 2 !.tran 0 1m 0 100n\n;.ac dec 10 1k 1Meg
TEXT -384 544 Left 2 ;Differential pair\nMind to seperate layout GND path with power GND
TEXT -1016 -624 Left 2 ;From the simulation result the opamp is not able to meet the inductance measurement requirements\nBut it may be good enought to sample in the switching mid points for FOC purpose
TEXT -520 -472 Left 2 ;AD8515: bandwidth 5MHz, slew rate: 2.7V/us\nLT6274: GBP 40MHz, >4.5V double supplied\nLTC6244: GBP 50MHz, 2.8V to 6V supplied, slew rate: 18~40V/us\nAD823: GBP 10MHz, slew rate: 13~22V/us\nstm32g431rb MCU OPAMP: GBP 7~13MHz, slew rate (High-speed mode) 18~45V/us, LS mode 2.5V~6.5V/us
RECTANGLE Normal -160 512 -384 16 2
